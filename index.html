<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPILL</title>
    <!-- Inline critical CSS to prevent FOUC -->
    <style>
        body { margin: 0; padding: 0; background: #0a0a0a; color: white; }
        .loading { text-align: center; padding: 2rem; color: #888; }
        #app { opacity: 0; transition: opacity 0.3s; }
    </style>
    <!-- Main stylesheet with load error handling -->
    <link rel="stylesheet" href="styles.css" onerror="handleStyleError()">
</head>
<body>
    <!-- Rest of the HTML structure remains the same... -->

    <!-- Resource Loading Script -->
    <script>
        // Track resource loading
        let resourcesLoaded = 0;
        const totalResources = 3; // CSS, weather.js, app.js

        function handleResourceLoad() {
            resourcesLoaded++;
            if (resourcesLoaded === totalResources) {
                document.getElementById('app').style.opacity = '1';
            }
        }

        function handleStyleError() {
            showError('Failed to load styles');
        }

        function showError(message) {
            const errorContainer = document.getElementById('errorContainer');
            const errorText = document.getElementById('errorText');
            if (errorContainer && errorText) {
                errorText.textContent = message;
                errorContainer.style.display = 'block';
            }
        }

        // Load JS resources
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = () => { handleResourceLoad(); resolve(); };
                script.onerror = () => {
                    console.error(`Failed to load ${src}`);
                    reject(new Error(`Failed to load ${src}`));
                };
                document.body.appendChild(script);
            });
        }

        // Initialize app
        async function initializeApp() {
            try {
                await Promise.all([
                    loadScript('weather.js'),
                    loadScript('app.js')
                ]);
            } catch (error) {
                showError(error.message);
                console.error('Resource loading error:', error);
            }
        }

        // Start loading resources
        window.addEventListener('DOMContentLoaded', () => {
            handleResourceLoad(); // Count CSS as loaded
            initializeApp();
        });
    </script>
</body>
</html>